<template>
  <!-- component -->
  <div>
    <section class="bg-section">
      <div class="text-white bg-setting bg-setting-local">
        <div class="container mx-auto flex flex-col md:flex-row items-center">
          <div
            class="flex flex-col w-full lg:w-1/3 justify-center p-8 items-center md:items-start"
          >
            <h1
              class="text-3xl md:text-5xl p-2 text-yellow-300 tracking-loose bg-section-word1"
            >
              News
            </h1>
            <h2
              class="text-3xl md:text-3xl p-2 leading-relaxed md:leading-snug mb-2 bg-section-word2"
            >
              Get Your Epic time
            </h2>
          </div>
          <div
            class="p-8 mt-12 mb-6 md:mb-0 md:mt-0 ml-0 md:ml-12 lg:w-2/3 justify-center"
          ></div>
        </div>
      </div>
    </section>
    <!-- component -->
    <div class="flex justify-center items-center">
      <div
        class="2xl:mx-auto 2xl:container lg:px-20 lg:py-16 md:py-12 md:px-6 py-9 px-4 w-96 sm:w-auto"
      >
        <div role="main" class="flex flex-col items-center justify-center">
          <h1
            class="text-4xl font-semibold leading-9 text-center text-gray-800 dark:text-gray-50"
          >
            This Week News
          </h1>
          <p
            class="text-base leading-normal text-center text-gray-600 dark:text-white mt-4 lg:w-1/2 md:w-10/12 w-11/12"
          >
            If you're looking for random paragraphs, you've come to the right
            place. When a random word or a random sentence isn't quite enough
          </p>
        </div>
        <div class="lg:flex items-stretch md:mt-12 mt-8">
          <div class="lg:w-1/2">
            <div
              class="sm:flex items-center justify-between xl:gap-x-8 gap-x-6"
            >
              <div class="sm:w-1/2 relative">
                <div>
                  <p
                    class="p-6 text-xs font-medium leading-3 text-white absolute top-0 right-0"
                  >
                    12 April 2021
                  </p>
                  <div class="absolute bottom-0 left-0 p-6">
                    <h2 class="text-xl font-semibold 5 text-white">
                      The Decorated Ways
                    </h2>
                    <p class="text-base leading-4 text-white mt-2">
                      Dive into minimalism
                    </p>
                    <a
                      href="javascript:void(0)"
                      class="focus:outline-none focus:underline flex items-center mt-4 cursor-pointer text-white hover:text-gray-200 hover:underline"
                    >
                      <p class="pr-2 text-sm font-medium leading-none">
                        Read More
                      </p>
                      <svg
                        class="fill-stroke"
                        width="16"
                        height="16"
                        viewBox="0 0 16 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M5.75 12.5L10.25 8L5.75 3.5"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </a>
                  </div>
                </div>
                <img
                  src="https://i.ibb.co/DYxtCJq/img-1.png"
                  class="w-full"
                  alt="chair"
                />
              </div>
              <div class="sm:w-1/2 sm:mt-0 mt-4 relative">
                <div>
                  <p
                    class="p-6 text-xs font-medium leading-3 text-white absolute top-0 right-0"
                  >
                    12 April 2021
                  </p>
                  <div class="absolute bottom-0 left-0 p-6">
                    <h2 class="text-xl font-semibold 5 text-white">
                      The Decorated Ways
                    </h2>
                    <p class="text-base leading-4 text-white mt-2">
                      Dive into minimalism
                    </p>
                    <a
                      href="javascript:void(0)"
                      class="focus:outline-none focus:underline flex items-center mt-4 cursor-pointer text-white hover:text-gray-200 hover:underline"
                    >
                      <p class="pr-2 text-sm font-medium leading-none">
                        Read More
                      </p>
                      <svg
                        class="fill-stroke"
                        width="16"
                        height="16"
                        viewBox="0 0 16 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M5.75 12.5L10.25 8L5.75 3.5"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </a>
                  </div>
                </div>
                <img
                  src="https://i.ibb.co/3C5HvxC/img-2.png"
                  class="w-full"
                  alt="wall design"
                />
              </div>
            </div>
            <div class="relative">
              <div>
                <p
                  class="md:p-10 p-6 text-xs font-medium leading-3 text-white absolute top-0 right-0"
                >
                  12 April 2021
                </p>
                <div class="absolute bottom-0 left-0 md:p-10 p-6">
                  <h2 class="text-xl font-semibold 5 text-white">
                    The Decorated Ways
                  </h2>
                  <p class="text-base leading-4 text-white mt-2">
                    Dive into minimalism
                  </p>
                  <a
                    href="javascript:void(0)"
                    class="focus:outline-none focus:underline flex items-center mt-4 cursor-pointer text-white hover:text-gray-200 hover:underline"
                  >
                    <p class="pr-2 text-sm font-medium leading-none">
                      Read More
                    </p>
                    <svg
                      class="fill-stroke"
                      width="16"
                      height="16"
                      viewBox="0 0 16 16"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M5.75 12.5L10.25 8L5.75 3.5"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </a>
                </div>
              </div>
              <img
                src="https://i.ibb.co/Ms4qyXp/img-3.png"
                alt="sitting place"
                class="w-full mt-8 md:mt-6 hidden sm:block"
              />
              <img
                class="w-full mt-4 sm:hidden"
                src="https://i.ibb.co/6XYbN7f/Rectangle-29.png"
                alt="sitting place"
              />
            </div>
          </div>
          <div
            class="lg:w-1/2 xl:ml-8 lg:ml-4 lg:mt-0 md:mt-6 mt-4 lg:flex flex-col justify-between"
          >
            <div class="relative">
              <div>
                <p
                  class="md:p-10 p-6 text-xs font-medium leading-3 text-white absolute top-0 right-0"
                >
                  12 April 2021
                </p>
                <div class="absolute bottom-0 left-0 md:p-10 p-6">
                  <h2 class="text-xl font-semibold 5 text-white">
                    The Decorated Ways
                  </h2>
                  <p class="text-base leading-4 text-white mt-2">
                    Dive into minimalism
                  </p>
                  <a
                    href="javascript:void(0)"
                    class="focus:outline-none focus:underline flex items-center mt-4 cursor-pointer text-white hover:text-gray-200 hover:underline"
                  >
                    <p class="pr-2 text-sm font-medium leading-none">
                      Read More
                    </p>
                    <svg
                      class="fill-stroke"
                      width="16"
                      height="16"
                      viewBox="0 0 16 16"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M5.75 12.5L10.25 8L5.75 3.5"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </a>
                </div>
              </div>
              <img
                src="https://i.ibb.co/6Wfjf2w/img-4.png"
                alt="sitting place"
                class="w-full sm:block hidden"
              />
              <img
                class="w-full sm:hidden"
                src="https://i.ibb.co/dpXStJk/Rectangle-29.png"
                alt="sitting place"
              />
            </div>
            <div
              class="sm:flex items-center justify-between xl:gap-x-8 gap-x-6 md:mt-6 mt-4"
            >
              <div class="relative w-full">
                <div>
                  <p
                    class="p-6 text-xs font-medium leading-3 text-white absolute top-0 right-0"
                  >
                    12 April 2021
                  </p>
                  <div class="absolute bottom-0 left-0 p-6">
                    <h2 class="text-xl font-semibold 5 text-white">
                      The Decorated Ways
                    </h2>
                    <p class="text-base leading-4 text-white mt-2">
                      Dive into minimalism
                    </p>
                    <a
                      href="javascript:void(0)"
                      class="focus:outline-none focus:underline flex items-center mt-4 cursor-pointer text-white hover:text-gray-200 hover:underline"
                    >
                      <p class="pr-2 text-sm font-medium leading-none">
                        Read More
                      </p>
                      <svg
                        class="fill-stroke"
                        width="16"
                        height="16"
                        viewBox="0 0 16 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M5.75 12.5L10.25 8L5.75 3.5"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </a>
                  </div>
                </div>
                <img
                  src="https://i.ibb.co/3yvZBpm/img-5.png"
                  class="w-full"
                  alt="chair"
                />
              </div>
              <div class="relative w-full sm:mt-0 mt-4">
                <div>
                  <p
                    class="p-6 text-xs font-medium leading-3 text-white absolute top-0 right-0"
                  >
                    12 April 2021
                  </p>
                  <div class="absolute bottom-0 left-0 p-6">
                    <h2 class="text-xl font-semibold 5 text-white">
                      The Decorated Ways
                    </h2>
                    <p class="text-base leading-4 text-white mt-2">
                      Dive into minimalism
                    </p>
                    <a
                      href="javascript:void(0)"
                      class="focus:outline-none focus:underline flex items-center mt-4 cursor-pointer text-white hover:text-gray-200 hover:underline"
                    >
                      <p class="pr-2 text-sm font-medium leading-none">
                        Read More
                      </p>
                      <svg
                        class="fill-stroke"
                        width="16"
                        height="16"
                        viewBox="0 0 16 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M5.75 12.5L10.25 8L5.75 3.5"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </a>
                  </div>
                </div>
                <img
                  src="https://i.ibb.co/gDdnJb5/img-6.png"
                  class="w-full"
                  alt="wall design"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- list-section -->
    <div
      class="container mx-auto 2xl:mx-auto 2xl:container lg:px-20 lg:py-16 md:py-12 md:px-6 py-9 px-4 w-96 sm:w-auto"
    >
      <h1
        class="heading-line text-4xl font-semibold leading-9 text-center text-gray-800 dark:text-gray-50 my-10"
        style="margin: 0 0 5px"
      >
        <span>Latest News</span>
      </h1>
      <div class="news-content">
        <div class="main-content" v-for="(item, i) in items" :key="`news${i}`">
          <div
            class="bg-white shadow-md border border-gray-200 rounded-lg max-w-sm mb-5 mx-3"
          >
            <div
              class="news-img cursor-pointer"
              @click.prevent="showDetail(item)"
            >
              <img class="rounded-t-lg" :src="item.image" :alt="item.title" />
            </div>
            <div class="p-5">
              <a href="#" @click.prevent="showDetail(item)">
                <h5
                  class="text-gray-900 font-bold text-xl tracking-tight mb-2 title-outline"
                  :title="item.title"
                >
                  {{ item.title || "" }}
                </h5>
              </a>
              <div class="wrapper-outline">
                <p class="content-outline">
                  {{ item.outline || "" }}
                </p>
              </div>
              <div class="flex justify-end mt-2">
                <a
                  class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-3 py-2 text-center inline-flex items-center mr-1"
                  href="#"
                  @click.prevent="showDetail(item)"
                >
                  Read more
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer class="grid grid-flow-col auto-cols-max justify-center">
      <Paginator
        v-model:first="offset"
        v-model:rows="rows"
        :totalRecords="totalItemsCount"
      ></Paginator>
    </footer>
  </div>
</template>

<script>
import { inject, ref, defineComponent, onMounted } from "vue";
import { getCustomerArticle } from "Service/apis.js";
import { useToast } from "vue-toastification";
import dayjs from "dayjs";
import { useRoute, useRouter } from "vue-router";

export default defineComponent({
  props: {},
  setup(props, { emit }) {
    const router = useRouter();
    const route = useRoute();
    const toast = useToast();
    const offset = ref(0);
    const rows = ref(10);
    const totalItemsCount = ref(1);
    const items = ref([]);
    const getData = async () => {
      try {
        const page = +offset.value / +rows.value + +1;
        const skip = (page - 1) * rows.value;
        const top = rows.value;
        const res = await getCustomerArticle(`?page=${page}`);

        let arr = [...res.data?.articles];
        arr = arr.map((s) => {
          s.timeforshow = dayjs(new Date(+s.create_at)).format(
            "YYYY/MM/DD HH:mm:ss"
          );
          return s;
        });
        items.value = [...arr];
        totalItemsCount.value = +res.data?.pagination?.total_pages * 10;
      } catch (e) {
        toast.error(`${e.response ? e.response.data : e}`, {
          timeout: 2000,
          hideProgressBar: true,
        });
      }
    };

    const showDetail = (item) => {
      window.scrollTo({
        top: 0,
        left: 0,
        // behavior: "smooth",
      });
      router.push({
        name: "newsdetail",
        params: { newsId: item.id },
      });
    };

    onMounted(async () => {
      await getData();
    });
    return {
      offset,
      rows,
      totalItemsCount,
      items,
      getData,
      showDetail,
    };
  },
});
</script>

<style lang="scss" scoped>
.news-content {
  display: grid;
  justify-content: center;
  grid-template-columns: 1fr 1fr 1fr 1fr;
}

@media (max-width: 575px) {
  .news-content {
    grid-template-columns: 1fr;
  }
}

.bg-section {
  height: 437px;
  margin-bottom: 100px;
}

.bg-setting-local {
  padding: 200px 0 120px 0;
  background: url("https://images.unsplash.com/photo-1617317376997-8748e6862c01?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80");
  background-position: 50% 65%;
  background-size: cover;
}

@media (max-width: 575px) {
  .bg-section {
    height: 220px;
    margin-bottom: 160px;
  }

  .bg-section-word1 {
    margin-top: 60px;
  }

  .bg-section-word2 {
    display: none;
  }

  .bg-setting-local {
    padding: 50px 0 5px 0;
  }

  .bg-setting-local {
    background-position: 102% 74%;
  }
}
.title-outline {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
.wrapper-outline {
  .content-outline {
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
  }
}
.news-img {
  height: 200px;
  overflow: hidden;
  img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s;
    &:hover {
      transform: scale(1.1);
    }
  }
}
</style>
