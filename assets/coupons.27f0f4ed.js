var H=Object.defineProperty;var j=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var N=(e,t,l)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,$=(e,t)=>{for(var l in t||(t={}))O.call(t,l)&&N(e,l,t[l]);if(j)for(var l of j(t))R.call(t,l)&&N(e,l,t[l]);return e};import{d as J,i as L,r as f,f as G,o as K,an as Y,x as C,k as i,l as s,F as A,q,m as D,z as u,t as b,ap as U,as as Q,aj as W,ak as X,j as c,aq as Z,p as S,ar as F,al as x}from"./vendor.d22d9ea1.js";import{_ as ee,l as oe,m as te,n as z,o as se,f as ae}from"./index.3999fec8.js";const ne=J({name:"function",components:{},setup(){L("emitter").on("addCoupons",a=>{V(1)});const t=f([{name:"Operate",key:"",sortDesc:null},{name:"Title",key:"title",sortDesc:null},{name:"Percent",key:"percent",sortDesc:null},{name:"Due Date",key:"due_date",sortDesc:null},{name:"Code",key:"code",sortDesc:null},{name:"IsEnabled",key:"is_enabled",sortDesc:null}]),l=f([]),I=f(0),w=f(10),P=f(1),d=G();async function _(){var a,n,B;try{const m=+I.value/+w.value+1,T=(m-1)*w.value,E=w.value,r=await oe(`?page=${m}`);console.log("res",r),l.value=[...(a=r.data)==null?void 0:a.coupons],P.value=+((B=(n=r.data)==null?void 0:n.pagination)==null?void 0:B.total_pages)*10}catch(m){d.error(`${m.response?m.response.data:m}`,{timeout:2e3,hideProgressBar:!0})}}K(async()=>{await _()}),Y(I,(a,n)=>{_()}),Y(w,(a,n)=>{_()});const v=f(!1),p=f(1),g=f({});function V(a,n){a==2||a==3?g.value=$({},n):g.value={title:"",is_enabled:!0,percent:90,due_date:null,code:""},p.value=a,v.value=!0}const o=async()=>{const a=$({},g.value);a.due_date=Q(a.due_date).format("YYYY-MM-DD");try{if(p.value==1){const n=await te({data:a})}if(p.value==2){const n=await z({data:a},a.id)}if(p.value==3){const n=await se(a.id)}d.info(`${p.value==1?"Add":p.value==2?"Edit":"Delete"}Success`,{timeout:2e3,hideProgressBar:!0})}catch(n){d.error(`${n.response?n.response.data:n}`,{timeout:2e3,hideProgressBar:!0})}_(),v.value=!1},k=async a=>{const n=$({},a);await z({data:n},n.id),_(),d.info("Coupon\u8ABF\u6574Success",{timeout:2e3,hideProgressBar:!0})},y=f("");return{onUpload:()=>{d.info("\u5716\u7247\u4E0A\u50B3Success",{timeout:3e3,hideProgressBar:!0})},uploadNewFile:async()=>{document.getElementById("file-upload").click()},fileChange:async a=>{var m,T,E;const n=a.target.files[0],B=Boolean(a.target.files[0])?a.target.files[0].name.split(".")[0]:"";try{if(!Boolean(B)){d.error("\u8ACB\u5148\u9078\u64C7\u6A94\u6848",{timeout:2e3,hideProgressBar:!0});return}let r=new FormData;r.append("File",n);const M=await ae(r);console.log("res",M),((m=M.data)==null?void 0:m.info)?(g.value.imagesArr[0].url=M.data.imageUrl,d.info("\u4E0A\u50B3\u5716\u7247Success",{timeout:2e3,hideProgressBar:!0})):d.error(`\u4E0A\u50B3\u5716\u7247\u5931\u6557: ${(E=(T=M.data)==null?void 0:T.message)==null?void 0:E.code}`,{timeout:2e3,hideProgressBar:!0})}catch(r){d.error(`${r.response?r.response.data:r}`,{timeout:2e3,hideProgressBar:!0})}document.getElementById("file-upload").value=""},images:y,headers:t,items:l,toast:d,getData:_,offset:I,rows:w,totalItemsCount:P,editModal:v,modalItem:g,nowType:p,showEditModal:V,saveEditModal:o,setStatus:k}}}),h=e=>(W("data-v-1469bd3a"),e=e(),X(),e),le={class:"main-section px-3"},de=h(()=>s("section",{class:"search-block"},[s("h5",{class:"big-title"},"CouponManagement")],-1)),re={class:"ecommerce-grid my-dark"},ie=["onClick"],ue={key:0},ce=h(()=>s("i",{class:"pi pi-sort"},null,-1)),pe=[ce],me={key:1},fe=h(()=>s("i",{class:"pi pi-caret-up"},null,-1)),he=[fe],_e={key:2},ge=h(()=>s("i",{class:"pi pi-caret-down"},null,-1)),ve=[ge],ye={class:"content",style:{cursor:"pointer","padding-top":"3px"}},be=["onClick"],we=["onClick"],ke=["title"],Ce=["title"],De=["title"],Ie=["title"],Ve=["title"],Be={key:0,class:"mt-2 text-center text-xl font-semibold col-span-full",style:{"font-family":"Microsoft JhengHei, Helvetica"}},Me={class:"grid grid-flow-col auto-cols-max justify-center"},$e={class:"mt-4"},Pe={class:"modal-main-content"},Te={key:0,class:"mb-2 font-black text-xl"},Ee={class:"p-inputgroup mt-2 col-span-full"},Ue=h(()=>s("span",{class:"p-inputgroup-addon red-star"},"Title",-1)),Se={class:"p-inputgroup mt-2"},Fe=h(()=>s("span",{class:"p-inputgroup-addon red-star"},"Percent",-1)),je={class:"p-inputgroup mt-2"},Ne=h(()=>s("span",{class:"p-inputgroup-addon red-star"},"Due Date",-1)),Ye={class:"p-inputgroup mt-2"},Ae=h(()=>s("span",{class:"p-inputgroup-addon red-star"},"Code",-1)),qe={class:"p-inputgroup mt-2"},ze=h(()=>s("span",{class:"p-inputgroup-addon"},"IsEnabled",-1));function He(e,t,l,I,w,P){const d=C("Checkbox"),_=C("Paginator"),v=C("InputText"),p=C("Calendar"),g=C("Button"),V=C("Dialog");return c(),i("section",le,[de,s("header",re,[(c(!0),i(A,null,q(e.headers,(o,k)=>(c(),i("div",{key:`headers${k}`,class:"header",onClick:y=>e.sort(o)},[Z(b(o.name)+" ",1),o.key?S((c(),i("span",ue,pe,512)),[[F,o.sortDesc===null]]):D("",!0),o.key?S((c(),i("span",me,he,512)),[[F,o.sortDesc===!1]]):D("",!0),o.key?S((c(),i("span",_e,ve,512)),[[F,o.sortDesc]]):D("",!0)],8,ie))),128))]),(c(!0),i(A,null,q(e.items,(o,k)=>(c(),i("main",{class:"ecommerce-grid",key:`content${k}`,style:x([{color:"#39312e"},k%2==0?"background-color:#ffffff ;":"background-color:#e7f2f3;"])},[s("div",ye,[s("button",{class:"text-white font-bold uppercase px-4 py-2 rounded shadow hover:shadow-md outline-none focus:outline-none mr-2 mb-1 text-sm",type:"button",style:{background:"#0d4a9e"},onClick:y=>e.showEditModal(2,o)}," Edit ",8,be),s("button",{class:"text-white font-bold uppercase px-4 py-2 rounded shadow hover:shadow-md outline-none focus:outline-none mr-1 mb-1 text-sm",type:"button",style:{background:"#218be1"},onClick:y=>e.showEditModal(3,o)}," Delete ",8,we)]),s("div",{class:"content",title:o.title},b(o.title||""),9,ke),s("div",{class:"content",title:o.percent},b(o.percent||""),9,Ce),s("div",{class:"content",title:o.due_date},b(o.due_date||""),9,De),s("div",{class:"content",title:o.code},b(o.code||""),9,Ie),s("div",{class:"content",title:o.is_enabled},[u(d,{binary:!0,modelValue:o.is_enabled,"onUpdate:modelValue":y=>o.is_enabled=y,onChange:y=>e.setStatus(o)},null,8,["modelValue","onUpdate:modelValue","onChange"])],8,Ve)],4))),128)),e.items.length?D("",!0):(c(),i("main",Be," No Data ")),s("footer",Me,[u(_,{first:e.offset,"onUpdate:first":t[0]||(t[0]=o=>e.offset=o),rows:e.rows,"onUpdate:rows":t[1]||(t[1]=o=>e.rows=o),rowsPerPageOptions:[5,10,50],totalRecords:e.totalItemsCount},null,8,["first","rows","totalRecords"]),s("div",$e,"\u5171"+b(e.totalItemsCount)+"\u7B46",1)]),u(V,{visible:e.editModal,"onUpdate:visible":t[8]||(t[8]=o=>e.editModal=o),style:{width:"85vw"},draggable:!1,modal:!0,class:"custom-modal"},{header:U(()=>[s("h3",null,b(e.nowType==1?"AddCoupon":e.nowType==2?"EditCoupon":"DeleteCoupon"),1)]),footer:U(()=>[u(g,{label:"Confirm",onClick:e.saveEditModal},null,8,["onClick"]),u(g,{label:"Cancel",class:"p-button-success",onClick:t[7]||(t[7]=o=>e.editModal=!1)})]),default:U(()=>[s("section",Pe,[e.nowType==3?(c(),i("h2",Te," Delete This Coupon? ")):D("",!0),s("div",Ee,[Ue,u(v,{type:"text",modelValue:e.modalItem.title,"onUpdate:modelValue":t[2]||(t[2]=o=>e.modalItem.title=o),modelModifiers:{trim:!0},disabled:e.nowType==3,class:"custom-search"},null,8,["modelValue","disabled"])]),s("div",Se,[Fe,u(v,{modelValue:e.modalItem.percent,"onUpdate:modelValue":t[3]||(t[3]=o=>e.modalItem.percent=o),modelModifiers:{trim:!0},class:"custom-search",disabled:e.nowType==3,type:"Number"},null,8,["modelValue","disabled"])]),s("div",je,[Ne,u(p,{modelValue:e.modalItem.due_date,"onUpdate:modelValue":t[4]||(t[4]=o=>e.modalItem.due_date=o),showIcon:!0,dateFormat:"yy-mm-dd",style:{height:"40px"},class:"hidden-item",disabled:e.nowType==3},null,8,["modelValue","disabled"])]),s("div",Ye,[Ae,u(v,{modelValue:e.modalItem.code,"onUpdate:modelValue":t[5]||(t[5]=o=>e.modalItem.code=o),modelModifiers:{trim:!0},class:"custom-search",disabled:e.nowType==3},null,8,["modelValue","disabled"])]),s("div",qe,[ze,u(d,{style:{margin:"12px 0 0 10px"},binary:!0,modelValue:e.modalItem.is_enabled,"onUpdate:modelValue":t[6]||(t[6]=o=>e.modalItem.is_enabled=o)},null,8,["modelValue"])])])]),_:1},8,["visible"])])}var Qe=ee(ne,[["render",He],["__scopeId","data-v-1469bd3a"]]);export{Qe as default};
